<!DOCTYPE html>
<html>
<head>
  <title>DragonLi Web Interface</title>
</head>
<body>
  <h1>DragonLi</h1>
  <p>A word equation solver</p>

<form onsubmit="return sendForm(event)">
  <!-- select benchmark -->
  <label for="benchmark">Benchmark:</label>
  <select id="benchmark" name="benchmark">
    <option value="A1">A1</option>
    <option value="A2">A2</option>
    <option value="B">B</option>
  </select>
  <br /><br />

<!-- select sorteq function -->
  <label for="solverType">SortEqs function:</label>
  <select id="solverType" name="solverType">
    <option value="category">Baseline</option>
    <option value="hybrid_category_gnn_random">Random</option>
    <option value="category_gnn_first_n_iterations">GNN</option>
  </select>
  <br /><br />

  <!-- select task -->
  <label for="rankTask">Rank task:</label>
  <select id="rankTask" name="rankTask">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
  </select>
  <br /><br />

   <!-- select timeout_in_second -->
  <label for="timeout_in_second">Timeout in second:</label>
  <select id="timeout_in_second" name="timeout_in_second">
    <option value="5">5</option>
    <option value="10">10</option>
    <option value="30">30</option>
    <option value="60">60</option>
    <option value="300">300</option>
  </select>
  <br /><br />

  <label for="userInput">Enter a word equation problem:</label><br /><br />
  <textarea id="userInput" name="userInput" rows="30" cols="140"></textarea>
  <br /><br />



  <button type="submit">Submit</button>
</form>


  <!-- The solver's output or status messages go here -->
  <div id="solverOutput"
       style="margin-top: 20px; border: 1px solid #ccc; padding: 10px;">
    <!-- Will be filled in by JavaScript -->
  </div>

  <script>
    // 1. On page load, fetch the file contents from /load-eq
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        const response = await fetch('/load-eq');
        if (!response.ok) {
          throw new Error('Error fetching EQ file');
        }
        const fileContents = await response.text();
        document.getElementById('userInput').value = fileContents;
      } catch (error) {
        console.error('Could not load file:', error);
      }
    });

    // 2. On submit, POST the userâ€™s text to /process, run solver, and get answer
  async function sendForm(event) {
  event.preventDefault();
  const solverOutputDiv = document.getElementById('solverOutput');

  solverOutputDiv.textContent = 'Processing...';

  // Extract values from the form
  const input = document.getElementById('userInput').value;
  const solverType = document.getElementById('solverType').value;  // <--- get solverType
  const rankTask = document.getElementById('rankTask').value;  // <--- get rankTask
  const benchmark = document.getElementById('benchmark').value;  // <--- get benchmark
  const timeout_in_second = document.getElementById('timeout_in_second').value;  // <--- get timeout_in_second

  try {
    const response = await fetch('/process', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      // Now send received inputs in the JSON body
      body: JSON.stringify({
        userInput: input,
        solverType: solverType,
        rankTask: rankTask,
        benchmark: benchmark,
        timeout_in_second: timeout_in_second
      })
    });

    const result = await response.json();
    if (response.ok) {
      solverOutputDiv.textContent = result.solverOutput;
    } else {
      solverOutputDiv.textContent =
        'Solver Error: ' + (result.message || 'Unknown error');
    }
  } catch (error) {
    console.error('Network or server error:', error);
    solverOutputDiv.textContent =
      'An error occurred. Check the console for details.';
  }
  return false;
}
  </script>
</body>
</html>
